apiVersion: migration.openshift.io/v1alpha1
kind: MigStorage
metadata:
  labels:
    controller-tools.k8s.io: "1.0"
  name: {{ mig_storage_name }}
  namespace: {{ mig_namespace }}
spec:
  backupStorageProvider: {{ mig_backup_storage_provider }}
  volumeSnapshotProvider: {{ mig_volume_snapshot_provider }}
  
  backupStorageConfig:
    # [!] Change awsBucketName to contain the S3 bucket name to be used for migration
    awsBucketName: {{ mig_aws_bucket }}
    # [!] Change awsRegion to contain the region name (e.g. 'us-east-1') where the S3 bucket presides
    awsRegion: {{ mig_aws_region }}
    credsSecretRef:
      namespace: {{ mig_namespace }}
      name: {{ mig_storage_creds_name }}

    # Optional backupStorageConfig parameters
    #awsKmsKeyId: foo
    #awsPublicUrl: foo
    #awsSignatureVersion: "4"

  volumeSnapshotConfig:
    # [!] Change awsRegion to contain the region name (e.g. 'us-east-1') where Volume Snapshots should take place
    awsRegion: {{ mig_aws_region }}
    credsSecretRef:
      namespace: {{ mig_namespace }}
      name: {{ mig_storage_creds_name }}

